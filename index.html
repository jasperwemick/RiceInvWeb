<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, intitial-scale=1.0">
    <title>Rice Invitational</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="animations.css">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.css" type='text/css'>
    <script type="text/javascript" src="profile.js"></script>
</head>
<body>
    <!-- Front Page -->
    <section class="header">
        <nav>
            <a href="index.html"><img src="assets/title.png"></a>
            <div class="nav-links" id = "navLinks">         
                <i class="fa fa-times" onclick="hideMobileMenu()"></i>
                <ul>
                    <li><a href="">About</a></li>
                    <li><a href="">Players</a></li>
                    <li><a href="">Schedule</a></li>
                    <li><a href="standings.html">Standings</a></li>
                    <li><a href="tetris.html">Random</a></li>
                </ul>
            </div>
            <i class="fa fa-bars" onclick="showMobileMenu()"></i>
        </nav>
        
        <div class="text-box">
            <h1>The Rice Invitational</h1>
            <p>Here at the Rice Invitational, players strive for the pinnacle achievement in gaming: The Rice World Championship Cup.<br><br>This
                might not make a whole lot of sense, and that's because it doesn't.
            </p>
            <a href="" class="about-button">Cool Button</a>
        </div>
    </section>
    <!-- Players -->
    <section class="players">
        <div class="visible-player-content" id="temp_id">
            <h1>Players</h1>
            <p>Our players come from a multitude of backgrounds that truly makes each and every one of them a very special boy!</p>
            <div class="player_block" id="p_block">
                <div class="row_index">
                    <div class="player_index">
                        <img src="assets/ryan_player.png">
                        <h3>obbyota</h3>
                    </div>
                    <div class="player_index">
                        <img src="assets/luc_player.png">
                        <h3>cola</h3>
                    </div>
                    <div class="player_index">
                        <img src="assets/lizarazu_player.png">
                        <h3>sp1cybo1</h3>
                    </div>
                    <div class="player_index">
                        <img src="assets/neil_player.png">
                        <h3>cows</h3>
                    </div>
                </div>
                <div class="row_index">
                    <div class="player_index">
                        <img src="assets/john_player.png">
                        <h3>BestPurpleMaster</h3>
                    </div>
                    <div class="player_index">
                        <img src="assets/long_player.png">
                        <h3>VietPapi</h3>
                    </div>
                    <div class="player_index">
                        <img src="assets/paolo_player.png">
                        <h3>SioPaoPao</h3>
                    </div>
                    <div class="player_index">
                        <img src="assets/woods_player.png">
                        <h3>Striking Panic</h3>
                    </div>
                </div>
                <div class="row_index">
                    <div class="player_index">
                        <img src="assets/noahS_player.png">
                        <h3>Cody Travis</h3>
                    </div>
                    <div class="player_index">
                        <img src="assets/lee_player.png">
                        <h3>FewRaccoon69443</h3>
                    </div>
                    <div class="player_index">
                        <img src="assets/ron_player.png">
                        <h3>Melodii</h3>
                    </div>
                    <div class="player_index">
                        <img src="assets/player_thai.png">
                        <h3>Mcgurdstream</h3>
                    </div>
                </div>
                <div class="row_index">
                    <div class="player_index">
                        <img src="assets/dong_player.png">
                        <h3>YouKooKoo</h3>
                    </div>
                    <div class="player_index">
                        <img src="assets/keaton_player.png">
                        <h3>Rattle KILL</h3>
                    </div>
                    <div class="player_index">
                        <img src="assets/caleb_player.png">
                        <h3>Pimplord</h3>
                    </div>
                    <div class="player_index">
                        <img src="assets/kien_player.png">
                        <h3>Rantstand</h3>
                    </div>
                </div>
            </div>
        </div>

        <div class="content-canvas hidden-content" id="canvas">
            <div style="position: absolute; width: 500px; height: 500px; box-shadow: 0 0 40px 0px rgba(0, 0, 0, 0.7);">
                <img src="", style="position: relative;", id="canvas-img">
            </div>
            <div style="position: absolute; left: 700px; width: 800px; height: 1000px; box-shadow: 0 0 40px 0px rgba(0, 0, 0, 0.7);">
                <p></p>
            </div>

            <button class="exit-button" style="position: absolute; right:100px;" id="canvas-exit"></button>

            <div class="folder-object" id="fold" style="top: 50%; scale: 70%;">
                <div class="folder-animation">
                    <div class="folder-back">
                        <div class="folder-back-bump"></div>
                    </div>
                    <div class="file">
                        <img src="", id="file-img">
                        <div class="file-text"></div>
                    </div>
                    <div class="folder-front">
                        <div class="folder-front-divit"></div>
                    </div>
                </div>
            </div>

            <div class="tv-object" id="tv" style="top: 50%; left: 35%; scale: 70%;">
                <div class="tv-animation">
                    <div class="tv-body">
                        <div class="rounded-side" style="left: -12px; width: 30px; height: 325px; background: hsl(0, 0%, 10%);"></div>
                        <div class="rounded-side" style="right: -12px; width: 30px; height: 325px; background: hsl(0, 0%, 10%);"></div>
                        <div class="rounded-side" style="top: -8px; width: 500px; height: 20px; background: hsl(0, 0%, 10%);"></div>
                        <div class="rounded-side" style="bottom: -8px; width: 500px; height: 20px; background: hsl(0, 0%, 10%);"></div>
                        <div class="tv-stand"></div>
                    </div>
                    <div class="screen-base">
                        <div class="rounded-side" style="left: -12px; width: 30px; height: 275px; background: rgb(210, 255, 255);"></div>
                        <div class="rounded-side" style="right: -12px; width: 30px; height: 275px; background: rgb(210, 255, 255);"></div>
                        <div class="rounded-side" style="top: -8px; width: 350px; height: 20px; background: rgb(210, 255, 255);"></div>
                        <div class="rounded-side" style="bottom: -8px; width: 350px; height: 20px; background: rgb(210, 255, 255);"></div>
                        <div class="screen"></div>
                    </div>
                    <div class="antenna-base">
                        <div class="antenna" style="width: 20px; height: 125px; left: 75px; bottom: 75px; rotate: 15deg;"></div>
                        <div class="antenna" style="width: 100px; height: 20px; left: 88px; bottom: 168px; rotate: 15deg;"></div>
                        <div class="antenna" style="width: 20px; height: 150px; left: 124px; bottom: 40px; rotate: 40deg;"></div>
        
                        <div class="antenna" style="width: 20px; height: 75px; left: 10px; bottom: 75px; rotate: -20deg;"></div>
                        <div class="antenna" style="width: 75px; height: 20px; left: -58px; bottom: 128px; rotate: 0deg;"></div>
                        <div class="antenna" style="width: 20px; height: 125px; left: -24px; bottom: 34px; rotate: -40deg;"></div>
                    </div>
                    <div class="appendages-background">
                        <div class="knob">
                            <div class="inner-knob"></div>
                        </div>
                        <div class="knob">
                            <div class="inner-knob"></div>
                        </div>
                        <div class="vent"></div>
                    </div>
                </div>
            </div>
            
            <div>
                <div class="page hidden-content"></div>
                <div class="page hidden-content"></div>
                <div class="page hidden-content"></div>
            </div>

            <div class="chart-object" style="top: 50%; left: 70%; scale: 70%;">
                <div class="chart-animation">
                    <div class="chart-body">
                        <div class="bottom-bar"></div>
                        <div class="red-col"></div>
                        <div class="yellow-col"></div>
                        <div class="green-col"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>





    <!-- Mobile Navigation Bar -->
    <script>
        var navLinks = document.getElementById("navLinks");

        function showMobileMenu(){
            navLinks.style.right = "0px";
        }
        function hideMobileMenu(){
            navLinks.style.right = "-200px";
        }
    </script>

    <!-- Player Content Load/Unload -->
    <script>        
        var htmlPages = null;
        var pageList = [];
        var ONE_SEC_TIMEOUT = 1000;
        var HALF_SEC_TIMEOUT = 500;
        var QUARTER_SEC_TIMEOUT = 250;

        var folder = document.getElementById("fold");
        var television = document.getElementById("tv");
        var profiles = document.getElementById("temp_id");
        var canvas = document.getElementById("canvas");
        var exit = document.getElementById("canvas-exit");

        document.addEventListener('click', (event) => {
            if (event.target.classList.contains("player_index")) { // Detection for a click within the area of a player's profile picture
                
                let name = event.target.lastElementChild.innerHTML;
                var content = findName(name);
                canvas.firstElementChild.firstElementChild.src = content.firstBlockImage;
                canvas.firstElementChild.nextElementSibling.firstElementChild.innerHTML = content.firstBlockText;

                const players = document.querySelectorAll('.player_index');
                profiles.classList.add("fade-out-animation");
                setTimeout(function() {
                    profiles.classList.add("hidden-content");
                    profiles.classList.remove("fade-out-animation");
                }, HALF_SEC_TIMEOUT - 10);


                setTimeout(function() {
                    canvas.firstElementChild.firstElementChild.classList.add("fade-in-mid-top-animation");
                    canvas.classList.remove("hidden-content");
                }, HALF_SEC_TIMEOUT);
                
                document.getElementById("file-img").src=content.headImg;

            }
            else if (!canvas.classList.contains("hidden-content")) { // The player specific UI is currently revealed

                const bounds = event.composedPath();
                if (!htmlPages) { // TEMPORARY - cards are visible after folder click
                    if (bounds.includes(exit)) { // Clicked exit button to return to profile view

                        // Fade out specific player profile and return profiles
                        canvas.classList.add("hidden-content");
                        setTimeout(function() { 
                            profiles.classList.remove("hidden-content");
                        }, HALF_SEC_TIMEOUT);
                    }
                    else if (bounds.includes(folder)) { // In this case, the user has clicked on the folder, revealing a set of pages/cards --> idk where exactly this is going yet
                        folder.classList.add("fade-out-animation");
                        television.classList.add("fade-out-animation")
                        htmlPages = canvas.lastElementChild.children;
                        for (let i = 0; i < htmlPages.length; i++) { // Instantiate Page objects to local JS list
                            pageList.push({
                                left: 50 + 2 * i, 
                                top: 50 + 2 * i, 
                                zIndex: 1 + htmlPages.length - i
                            });
                        }
                        setTimeout(folderToDocs, HALF_SEC_TIMEOUT - 25);
                        setTimeout(function() {
                            htmlPages.style.pointerEvents = "all";
                        }, 3 * ONE_SEC_TIMEOUT);
                    }
                    else if (bounds.includes(television)) {
                        
                    }
                }
                else { // Handles cards when visible
                    /* ----------------------------- This Portion can be optimized --------------------------- */
                    var page_found = false;
                    var front = 0
                    var max = 0
                    for (let i = 0; i < htmlPages.length; i++) {
                        if (event.composedPath().includes(htmlPages.item(i))) {
                            page_found = true;
                        }
                        if (htmlPages.item(i).style.zIndex > max) {
                            max = htmlPages.item(i).style.zIndex;
                            front = i;
                        }
                    }
                    /* --------------------------------------------------------------------------------------- */

                    if (!page_found) { // The user has clicked outside of the area of the pages/cards, resulting in them being removed from the screen
                        for (let i = 0; i < htmlPages.length; i++) {

                            htmlPages.item(i).classList.add("pop-down-animation");
                            setTimeout(function() {
                                htmlPages.item(i).classList.remove("pop-down-animation");
                                htmlPages.item(i).classList.add("hidden-content");
                                if (i == htmlPages.length - 1) {
                                    htmlPages = null;
                                }
                            }, ONE_SEC_TIMEOUT - 25);
                        }
                        pageList = [];
                        htmlPages.style.pointerEvents = "none";
                    }
                    else {
                        htmlPages.item(front).classList.add("back-of-stack-animation");
                        setTimeout(shiftDocs, QUARTER_SEC_TIMEOUT, front);
                        setTimeout(function() {
                            htmlPages.item(front).classList.remove("back-of-stack-animation");
                        }, HALF_SEC_TIMEOUT - 10);
                    }
                }
            }
        });

        function folderToDocs() { // Handles the animation transistions for going from folder -> pages/cards

            folder.classList.remove("fade-out-animation");
            folder.classList.add("hidden-content");
            television.classList.remove("fade-out-animation");
            television.classList.add("hidden-content");

            for (let i = 0; i < htmlPages.length; i++) {
                setTimeout(function() {
                    htmlPages.item(i).classList.add("slide-papers-right-animation");
                    htmlPages.item(i).classList.remove("hidden-content");
                    htmlPages.item(i).style.zIndex = pageList[i].zIndex;
                    htmlPages.item(i).style.left = pageList[i].left + "%";
                    htmlPages.item(i).style.top = pageList[i].top + "%";

                    setTimeout(function() {
                        htmlPages.item(i).classList.remove("slide-papers-right-animation");
                    }, ONE_SEC_TIMEOUT - 25);
                }, 300 * i);
            }
        }

        // this is broken loloolol
        function shiftDocs(frontIndex) {
            for (let j = 0; j < htmlPages.length; j++) {
                if (frontIndex != j) {
                    pageList[j].left -= 2;
                    pageList[j].top -= 2;
                    pageList[j].zIndex += 1;
                }
                else {
                    pageList[j].left += 2 * (pageList.length - 1);
                    pageList[j].top += 2 * (pageList.length - 1);
                    pageList[j].zIndex -= pageList.length - 1;
                }
                htmlPages.item(j).style.left = pageList[j].left + "%";
                htmlPages.item(j).style.top = pageList[j].top + "%";
                htmlPages.item(j).style.zIndex = pageList[j].zIndex;
            }
        }

        function findName(name) {
            for (var obj of pfData) {
                if (obj.name == name) {
                    return obj;
                }
            }
        }

    </script>

</body>
</html>